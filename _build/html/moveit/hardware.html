<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ROS2 Control Hardware &mdash; ROS2 Lunabot  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basics &amp; Setting Up States" href="../state_machine/index.html" />
    <link rel="prev" title="Moving your model: MoveIt" href="moveit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ROS2 Lunabot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/lunabotics.html">Intro to Lunabotics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing-ros-linux.html">Installing ROS2 on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing-ros-mac.html">Installing ROS2 on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installing-ros-windows.html">Installing ROS2 on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/virtual-machine.html">Virtual Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/repo-setup.html">Repository Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/vs-code.html">Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/commands.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/git.html">Git Standards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/best-practices.html">Best Practices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Intro Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/project1.html">Project 1: Keyboard Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/project2.html">Project 2: State Machine</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Important Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/ros.html">ROS Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/msgs.html">Messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/odometry.html">Odometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/coord-frames.html">Coordinate Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/rotation.html">Representing Rotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/slam.html">Localization &amp; Mapping</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MoveIt, From Start to Finish</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="urdf.html">Modeling the robot: URDFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="moveit.html">Moving your model: MoveIt</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ROS2 Control Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-configure">Hardware Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-export-state-interfaces">Hardware Export State Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-export-command-interfaces">Hardware Export Command Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-stop">Hardware Stop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-start">Hardware Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-read">Hardware Read</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-write">Hardware Write</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">State Machine</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../state_machine/index.html">Basics &amp; Setting Up States</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ROS Phoenix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ros_phoenix/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ros_phoenix/design.html">Package Design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Teleop Control</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../teleop_control/index.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Realsense</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../realsense/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../realsense/launch.html">Launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../realsense/parameters.html">Parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RTABMAP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rtabmap/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtabmap/launch.html">Launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtabmap/parameters.html">Parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Navigation2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../navigation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../navigation/launch.html">Launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../navigation/parameters.html">Parameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lidar</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lidar/installation.html">Urg Node Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lidar/electrical-setup.html">Electrical Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lidar/launchurgnode.html">Launch Urg Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lidar/launchlocalization.html">Launch Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lidar/parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lidar/localizationtheory.html">Localization Theory</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ROS2 Lunabot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ROS2 Control Hardware</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/moveit/hardware.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ros2-control-hardware">
<h1>ROS2 Control Hardware<a class="headerlink" href="#ros2-control-hardware" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>In order to interface moveit path planning with our Talon motor controllers, we have to use ROS2 control.
The ROS2 control framework allows us to directly input information from MoveIt into a controller that will provide the proper motor outputs
for successful arm movement. This interfacing is done by creating a subclass of the “hardware_interface” package, and we specify this information in
lines 11-13 of moveit_arm/config/excavation.ros2_control.xacro.
This page will break down each method of our arm_hardware class.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>ros-foxy-hardware-interface
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>ros-foxy-pluginlib
</pre></div>
</div>
</section>
<section id="hardware-configure">
<h2>Hardware Configure<a class="headerlink" href="#hardware-configure" title="Permalink to this heading"></a></h2>
<p>The configure method of the arm hardware is the first method run when the node starts. This method will run configure_default(info), which will
setup our joints, state interfaces, and command interfaces. The joints used for our arm are shoulder, elbow, and wrist (named appropriately).
The state interface refers to how we read in our current joint state. Because we link potentiometers to our speed controllers, the state
interfaces used are position and velocity (angular). The command interfaces refers to how we send commands to our speed controllers. Our Talons
operate based on percent_output meaning that it works on a scale of -1 to 1. Because of this, we use an effort command interface because it will
convert moveit commands onto an arbitrary scale of -1 to 1.</p>
<p>After all of this default configuration, we have some error handling to stop the node if the joints, state interfaces and command interfaces aren’t
properly setup. Finally, we set status to configured and return no errors.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="w"> </span><span class="nf">ArmHardware::configure</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HardwareInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">configure_default</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">ERROR</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">joints</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Arm Hardware should have exactly 3 joints&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">joint</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">joints</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">joint</span><span class="p">.</span><span class="n">command_interfaces</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="s">&quot;Joint &#39;%s&#39; needs to have exactly 1 command interface. Has &#39;%d&#39; instead&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">joint</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">joint</span><span class="p">.</span><span class="n">command_interfaces</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">joint</span><span class="p">.</span><span class="n">command_interfaces</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;effort&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="s">&quot;Joint &#39;%s&#39; can only have an effort command interface. Has &#39;%s&#39; instead&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">joint</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">joint</span><span class="p">.</span><span class="n">command_interfaces</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">()</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">joint</span><span class="p">.</span><span class="n">state_interfaces</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="s">&quot;Joint &#39;%s&#39; needs to have exactly 2 state interface. Has &#39;%d&#39; instead&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">joint</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">joint</span><span class="p">.</span><span class="n">state_interfaces</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">stateInterface</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">joint</span><span class="p">.</span><span class="n">state_interfaces</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stateInterface</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;position&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">stateInterface</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;velocity&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="s">&quot;Joint &#39;%s&#39; can only have position and velocity state interfaces. Has &#39;%s&#39; instead&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">joint</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"> </span><span class="n">stateInterface</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">c_str</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">status_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">status</span><span class="o">::</span><span class="n">CONFIGURED</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hardware-export-state-interfaces">
<h2>Hardware Export State Interfaces<a class="headerlink" href="#hardware-export-state-interfaces" title="Permalink to this heading"></a></h2>
<p>This method will properly setup the joint state interfaces list by looping through each joint and
setting all state interfaces to the proper value (i.e. shoulder position, shoulder velocity, elbow position, …).
If there is an unexpected joint, that joint will be logged to the terminal as a failure message.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">StateInterface</span><span class="o">&gt;</span>
<span class="n">ArmHardware</span><span class="o">::</span><span class="n">export_state_interfaces</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">StateInterface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stateInterfaces</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">jointName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;shoulder&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_POSITION</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">shoulderAngle</span><span class="p">);</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_VELOCITY</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">shoulderVel</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;elbow&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_POSITION</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">elbowAngle</span><span class="p">);</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_VELOCITY</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">elbowVel</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;wrist&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_POSITION</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wristAngle</span><span class="p">);</span>
<span class="w">        </span><span class="n">stateInterfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">jointName</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_VELOCITY</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wristVel</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Joint &#39;%s&#39; is invalid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">jointName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stateInterfaces</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hardware-export-command-interfaces">
<h2>Hardware Export Command Interfaces<a class="headerlink" href="#hardware-export-command-interfaces" title="Permalink to this heading"></a></h2>
<p>This method is very similar to the export state interfaces except it will add command interfaces instead of
state interfaces (i.e. shoulder effort, elbow effort, …)
If there is an unexpected joint, that joint will be logged to the terminal as a failure message.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">CommandInterface</span><span class="o">&gt;</span>
<span class="n">ArmHardware</span><span class="o">::</span><span class="n">export_command_interfaces</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">CommandInterface</span><span class="o">&gt;</span><span class="w"> </span><span class="n">command_interfaces</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">jointName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;shoulder&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">command_interfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_EFFORT</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">shoulderOutput</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;elbow&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">command_interfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_EFFORT</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">elbowOutput</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jointName</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;wrist&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">command_interfaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">info_</span><span class="p">.</span><span class="n">joints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">HW_IF_EFFORT</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wristOutput</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">RCLCPP_FATAL</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Joint &#39;%s&#39; is invalid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">jointName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">command_interfaces</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hardware-stop">
<h2>Hardware Stop<a class="headerlink" href="#hardware-stop" title="Permalink to this heading"></a></h2>
<p>This method is inherited from the ROS2 control demo stop method. Whenever the node is killed, the status is switched to stopped.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="w"> </span><span class="nf">ArmHardware::stop</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Stopping ...please wait...&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">status_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">status</span><span class="o">::</span><span class="n">STOPPED</span><span class="p">;</span>

<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;System successfully stopped!&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These above methods are based on the ROS2 control demo hardwares. The below methods are structured different than most tutorials because
they involve direct interaction with the Talons.</p>
</div>
</section>
<section id="hardware-start">
<h2>Hardware Start<a class="headerlink" href="#hardware-start" title="Permalink to this heading"></a></h2>
<p>The start method is normally responsible for just setting the control status to started. However, because our control system relies on potentiometer
data, which we obtain from published topics (/shoulder/angle, /shoulder/vel, /elbow/angle…), and our talons subscribe to output topics created by
the control system (/shoulder/set, /elbow/set, /wrist/set), we need to have publishers and subscribers. However, this class is not a node, it is a ROS
plugin, so that means we have to create a node inside of plugin. Therefore, along with updating the control status to start, this method creates a
node with the appropriate publishers, subscribers, and callbacks that will be updated in the read and write methods below.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="w"> </span><span class="nf">ArmHardware::start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Starting ...please wait...&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">executors</span><span class="o">::</span><span class="n">SingleThreadedExecutor</span><span class="o">::</span><span class="n">make_shared</span><span class="p">();</span>
<span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;arm_hardware_node&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">exec</span><span class="o">-&gt;</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>

<span class="w">    </span><span class="n">shoulderPub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;/shoulder/set&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="w">    </span><span class="n">elbowPub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;/elbow/set&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="w">    </span><span class="n">wristPub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;/wrist/set&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>

<span class="w">    </span><span class="n">shoulderAngleSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/shoulder/angle&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">shoulderAngleCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>
<span class="w">    </span><span class="n">elbowAngleSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/elbow/angle&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">elbowAngleCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>
<span class="w">    </span><span class="n">wristAngleSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/wrist/angle&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">wristAngleCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>

<span class="w">    </span><span class="n">shoulderVelSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/shoulder/vel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">shoulderVelCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>
<span class="w">    </span><span class="n">elbowVelSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/elbow/vel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">elbowVelCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>
<span class="w">    </span><span class="n">wristVelSub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float64</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;/wrist/vel&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ArmHardware</span><span class="o">::</span><span class="n">wristVelCallback</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">_1</span><span class="p">));</span>

<span class="w">    </span><span class="n">status_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">status</span><span class="o">::</span><span class="n">STARTED</span><span class="p">;</span>

<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;ArmHardware&quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;System Successfully started!&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hardware-read">
<h2>Hardware Read<a class="headerlink" href="#hardware-read" title="Permalink to this heading"></a></h2>
<p>The read method is responsible for setting the joint states topic. We get this data from the potetiometers, so we have to subscribe to the
shoulder, elbow, and wrist angle and velocity topics. Since this is a plugin, not a node, the topic pub/sub is a little complicated. In the start
method (see the previous section), we setup the subscribers and their callbacks to update the joint position and velocity variables. The read method
is responsible for running the node, which will update the callbacks, and set the variables for the joint angle topics.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="w"> </span><span class="nf">ArmHardware::read</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">exec</span><span class="o">-&gt;</span><span class="n">spin_once</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hardware-write">
<h2>Hardware Write<a class="headerlink" href="#hardware-write" title="Permalink to this heading"></a></h2>
<p>The write method is responsible for the actual motor movement. Our plugin will automatically update the command interface variables
(shoulder effort, elbow effort, wrist effort) to the percent output required for proper movement. This means this method must publish those outputs
to the Talon set topics (/shoulder/set, /elbow/set, /wrist/set). These publishers are setup in the previously mentioned start method,
so this method just creates the MotorControl message with the percent output and publish them to the set topics.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="w"> </span><span class="nf">ArmHardware::write</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">//RCLCPP_INFO(rclcpp::get_logger(&quot;ArmHardware&quot;), &quot;Writing...&quot;);</span>

<span class="w">    </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="w"> </span><span class="n">shoulderControl</span><span class="p">;</span>
<span class="w">    </span><span class="n">shoulderControl</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">::</span><span class="n">PERCENT_OUTPUT</span><span class="p">;</span>
<span class="w">    </span><span class="n">shoulderControl</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shoulderOutput</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="w">    </span><span class="n">shoulderPub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">shoulderControl</span><span class="p">);</span>

<span class="w">    </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="w"> </span><span class="n">elbowControl</span><span class="p">;</span>
<span class="w">    </span><span class="n">elbowControl</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">::</span><span class="n">PERCENT_OUTPUT</span><span class="p">;</span>
<span class="w">    </span><span class="n">elbowControl</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elbowOutput</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="w">    </span><span class="n">elbowPub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">elbowControl</span><span class="p">);</span>

<span class="w">    </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="w"> </span><span class="n">wristControl</span><span class="p">;</span>
<span class="w">    </span><span class="n">wristControl</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ros_phoenix_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MotorControl</span><span class="o">::</span><span class="n">PERCENT_OUTPUT</span><span class="p">;</span>
<span class="w">    </span><span class="n">wristControl</span><span class="p">.</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wristOutput</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="w">    </span><span class="n">wristPub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">wristControl</span><span class="p">);</span>


<span class="w">    </span><span class="c1">//RCLCPP_INFO(rclcpp::get_logger(&quot;ArmHardware&quot;), &quot;Joints successfully written!&quot;);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hardware_interface</span><span class="o">::</span><span class="n">return_type</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="moveit.html" class="btn btn-neutral float-left" title="Moving your model: MoveIt" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../state_machine/index.html" class="btn btn-neutral float-right" title="Basics &amp; Setting Up States" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Vanderbilt Robotics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>